@{
    ViewData["Title"] = "Карта на еко магазините";
}

<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" crossorigin="" />
<link rel="stylesheet" href="@Url.Content("~/css/map.css")" />

<div class="container">
    <h2 class="map-page-title">🗺️ Карта на еко магазините</h2>

    <div class="map-wrapper">
        <aside class="map-sidebar" aria-label="Map filters">
            <div class="sidebar-header-row">
                <div class="sidebar-title">🔎 Филтри</div>
            </div>

            <!-- Категория -->
            <div class="filter-section">
                <label>Категория</label>
                <select id="categorySelect" class="form-select">
                    <option value="*">Всички</option>
                    <option value="Еко храни">🥕 Био храни</option>
                    <option value="Натурална козметика">🧴 Натурална козметика</option>
                    <option value="Еко облекло">👕 Еко облекло</option>
                    <option value="Напитки">🍵 Напитки</option>
                    <option value="Продукти за дома">🧼 Продукти за дома</option>
                </select>
            </div>

            <!-- Разстояние -->
            <div class="filter-section">
                <label>Разстояние (км)</label>
                <select id="distanceSelect" class="form-select">
                    <option value="9999">Без лимит</option>
                    <option value="5">До 5 km</option>
                    <option value="10">До 10 km</option>
                    <option value="25" selected>До 25 km</option>
                    <option value="50">До 50 km</option>
                </select>
                <small class="small-muted">Работи спрямо текущото ви местоположение.</small>
            </div>

            <!-- Рейтинг -->
            <div class="filter-section">
                <label>Рейтинг</label>
                <select id="filterRating" class="form-select">
                    <option value="0">Всички</option>
                    <option value="3">≥ 3</option>
                    <option value="4">≥ 4</option>
                    <option value="4.5">≥ 4.5</option>
                </select>
            </div>

            <!-- EcoTags -->
            <div class="filter-section">
                <label>EcoTags</label>
                <select id="tagsSelect" class="form-select" multiple>
                    <option value="Zero-waste">♻️ Zero-waste</option>
                    <option value="Bio">🥕 Bio</option>
                    <option value="Local">🏡 Local</option>
                </select>
            </div>

            <!-- Други филтри -->
            <div class="filter-section">
                <label><input type="checkbox" id="filterOwn" /> Приема собствени опаковки</label>
                <label><input type="checkbox" id="filterOpen" /> Работи сега</label>
                <label><input type="checkbox" id="filterDelivery" /> Доставка</label>
                <label><input type="checkbox" id="filterRefill" /> Refills</label>
            </div>

            <div style="margin-top:12px;">
                <button id="btnReset" class="sidebar-full-btn popup-btn-outline">🔁 Нулирай филтрите</button>
            </div>

            <hr />

            <div>
                <div class="sidebar-title">Резултати</div>
                <div class="sidebar-results" id="resultsList">Зареждане…</div>
            </div>
        </aside>

        <div id="map"></div>
    </div>

    <section class="stores-list-section">
        <h3>Всички магазини</h3>
        <div id="storesList" class="sidebar-results">Зареждане…</div>
    </section>
</div>

<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js" crossorigin=""></script>
<script src="@Url.Content("~/js/map.js")"></script>

<script>
    document.addEventListener('DOMContentLoaded', function () {
        window.mapFilters = {
            categoryEl: document.getElementById('categorySelect'),
            distanceEl: document.getElementById('distanceSelect'),
            ownEl: document.getElementById('filterOwn'),
            openEl: document.getElementById('filterOpen'),
            deliveryEl: document.getElementById('filterDelivery'),
            refillEl: document.getElementById('filterRefill'),
            ratingEl: document.getElementById('filterRating'),
            tagsEl: document.getElementById('tagsSelect'),
            resultsEl: document.getElementById('resultsList'),
            storesListEl: document.getElementById('storesList')
        };
    });
</script>
